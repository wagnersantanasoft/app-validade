<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <title>Controle de Validade de Produtos</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">

    <!-- ================= LOGIN ================= -->
    <section id="login-view" class="view active">
      <div class="card login-card">
        <h1>Controle de Validade</h1>
        <form id="login-form">
          <label>
            UsuÃ¡rio
            <input type="text" id="username" autocomplete="username" required />
          </label>
          <label>
            Senha
            <input type="password" id="password" autocomplete="current-password" required />
          </label>
          <button type="submit" class="btn primary full">Entrar</button>
          <p id="login-error" class="error-msg" hidden></p>
        </form>
        <details class="mock-info">
          <summary>Credenciais de teste (API Mock)</summary>
          <p>UsuÃ¡rio: admin<br>Senha: admin123</p>
        </details>
      </div>
    </section>

    <!-- ================= DASHBOARD ================= -->
    <section id="dashboard-view" class="view">
      <header class="topbar">
        <div class="brand">
          <strong>Controle de Validade</strong>
          <span id="user-badge"></span>
        </div>
        <div class="topbar-actions">
          <button id="theme-toggle" class="btn small" title="Alternar tema">ðŸŒ“</button>
          <button id="add-product-btn" class="btn small primary" title="Adicionar produto">ï¼‹ Produto</button>
          <button id="refresh-btn" class="btn small">âŸ³ Atualizar</button>
          <button id="logout-btn" class="btn small danger">Sair</button>
        </div>
      </header>

      <main class="content">
        <section class="filters">
          <div class="filter-group">
            <label>
              Grupo
              <select id="group-filter">
                <option value="">Todos</option>
              </select>
            </label>
            <label>
              Buscar (nome, cÃ³digo ou cÃ³d. barras)
              <div class="search-flex">
                <input type="text" id="search-filter" placeholder="Ex: leite, L001, 789..." />
                <button type="button" id="scan-btn" class="btn small" title="Escanear cÃ³digo de barras">ðŸ“·</button>
                <button type="button" id="toggle-view" class="btn small" title="Alternar visualizaÃ§Ã£o">ðŸ—‚</button>
              </div>
            </label>
            <label>
              Dias p/ considerar 'PrÃ³ximo de Vencer'
              <input type="number" id="threshold-days" min="1" value="15" />
            </label>
            <label class="inline-checkbox">
              <input type="checkbox" id="show-removed" />
              Mostrar removidos
            </label>
          </div>

          <div class="segmented">
            <button data-status="all" class="seg-btn active">Todos</button>
            <button data-status="near" class="seg-btn">PrÃ³ximo de Vencer</button>
            <button data-status="expired" class="seg-btn">Vencidos</button>
          </div>
        </section>

        <!-- Table View -->
        <section class="table-wrapper" id="table-view">
          <table id="products-table">
            <thead>
              <tr>
                <th>CÃ³digo</th>
                <th>CÃ³d. Barras</th>
                <th>Produto</th>
                <th>Grupo</th>
                <th>Validade</th>
                <th>Dias Rest.</th>
                <th>Status</th>
                <th>AÃ§Ã£o</th>
              </tr>
            </thead>
            <tbody id="products-tbody">
              <tr><td colspan="8" class="center muted">Carregando...</td></tr>
            </tbody>
          </table>
        </section>

        <!-- Card View (mobile alternative) -->
        <section id="cards-view" class="cards-view hidden">
          <div id="cards-container" class="cards-grid">
            <!-- Cards gerados dinamicamente -->
          </div>
        </section>
      </main>

      <footer class="footer">
        <small>Exemplo demonstrativo â€¢ Ajuste livremente para produÃ§Ã£o</small>
      </footer>
    </section>
  </div>

  <!-- Scanner Overlay -->
  <div id="scanner-overlay" class="scanner-overlay hidden" role="dialog" aria-modal="true">
    <div class="scanner-inner">
      <div class="scanner-header">
        <strong>Escanear CÃ³digo de Barras</strong>
        <button id="close-scanner" class="btn small danger">âœ•</button>
      </div>
      <div class="video-wrapper">
        <video id="scanner-video" playsinline></video>
        <div class="scan-frame"></div>
      </div>
      <div class="scanner-footer">
        <span id="scanner-status" class="muted" style="font-size:.65rem;">Iniciando cÃ¢mera...</span>
        <div class="scanner-actions">
          <button id="toggle-torch" class="btn small" hidden>Lanterna</button>
          <button id="switch-camera" class="btn small" hidden>Trocar CÃ¢mera</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Adicionar Produto -->
  <div id="product-modal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modal-inner">
      <div class="modal-header">
        <strong id="modal-title">Novo Produto</strong>
        <button id="close-modal" class="btn small danger">âœ•</button>
      </div>
      <form id="product-form" autocomplete="off">
        <div class="form-grid">
          <label>
            CÃ³digo
            <input type="text" name="code" id="p-code" required />
          </label>
            <label>
            CÃ³digo de Barras
            <input type="text" name="barcode" id="p-barcode" />
          </label>
          <label class="full">
            Nome do Produto
            <input type="text" name="name" id="p-name" required />
          </label>
          <label>
            Grupo
            <input type="text" name="group" id="p-group" required />
          </label>
          <label>
            Validade
            <input type="date" name="expiryDate" id="p-expiryDate" required />
          </label>
        </div>
        <div class="modal-actions">
          <button type="submit" class="btn primary">Salvar</button>
          <button type="button" id="cancel-modal" class="btn">Cancelar</button>
        </div>
        <p id="product-error" class="error-msg" hidden></p>
      </form>
    </div>
  </div>

  <template id="row-template">
    <tr>
      <td class="col-code"></td>
      <td class="col-barcode"></td>
      <td class="col-name"></td>
      <td class="col-group"></td>
      <td class="col-expiry"></td>
      <td class="col-days"></td>
      <td class="col-status badge-cell"></td>
      <td class="col-action"></td>
    </tr>
  </template>

  <template id="card-template">
    <div class="product-card">
      <div class="pc-head">
        <span class="pc-code"></span>
        <span class="pc-status"></span>
      </div>
      <h4 class="pc-name"></h4>
      <dl class="pc-info">
        <div><dt>Grupo:</dt><dd class="pc-group"></dd></div>
        <div><dt>Barras:</dt><dd class="pc-barcode"></dd></div>
        <div><dt>Validade:</dt><dd class="pc-expiry"></dd></div>
        <div><dt>Dias:</dt><dd class="pc-days"></dd></div>
      </dl>
      <div class="pc-actions"></div>
    </div>
  </template>

  <script type="module" src="js/theme.js"></script>
  <script type="module" src="js/app.js"></script>
  <script type="module" src="js/scanner.js"></script>
</body>
</html>